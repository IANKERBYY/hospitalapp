{"ast":null,"code":"import _objectWithoutPropertiesLoose from\"@babel/runtime/helpers/objectWithoutPropertiesLoose\";const _excluded=[\"password\"];import React,{createContext,useState,useContext,useEffect}from'react';import AsyncStorage from'@react-native-async-storage/async-storage';import{users}from'../data/mockData';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=createContext({});export const AuthProvider=({children})=>{const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);useEffect(()=>{loadStoredUser();},[]);const loadStoredUser=async()=>{try{const storedUser=await AsyncStorage.getItem('@user');if(storedUser){setUser(JSON.parse(storedUser));}}catch(error){console.error('Error loading stored user:',error);}finally{setLoading(false);}};const login=async(username,password)=>{try{await new Promise(resolve=>setTimeout(resolve,1000));const foundUser=users.find(u=>u.username===username&&u.password===password);if(foundUser){const userWithoutPassword=_objectWithoutPropertiesLoose(foundUser,_excluded);await AsyncStorage.setItem('@user',JSON.stringify(userWithoutPassword));setUser(userWithoutPassword);return{success:true};}else{throw new Error('Invalid credentials');}}catch(error){return{success:false,error:error.message||'An error occurred during login'};}};const logout=async()=>{try{await AsyncStorage.removeItem('@user');setUser(null);return true;}catch(error){console.error('Logout error:',error);return false;}};const value={user,loading,login,logout,isAuthenticated:!!user};return _jsx(AuthContext.Provider,{value:value,children:!loading&&children});};export const useAuth=()=>{const context=useContext(AuthContext);if(!context){throw new Error('useAuth must be used within an AuthProvider');}return context;};","map":{"version":3,"names":["React","createContext","useState","useContext","useEffect","AsyncStorage","users","jsx","_jsx","AuthContext","AuthProvider","children","user","setUser","loading","setLoading","loadStoredUser","storedUser","getItem","JSON","parse","error","console","login","username","password","Promise","resolve","setTimeout","foundUser","find","u","userWithoutPassword","_objectWithoutPropertiesLoose","_excluded","setItem","stringify","success","Error","message","logout","removeItem","value","isAuthenticated","Provider","useAuth","context"],"sources":["C:/Users/pablo/HospitalApp/src/contexts/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useContext, useEffect } from 'react';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { users } from '../data/mockData';\r\n\r\nconst AuthContext = createContext({});\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [user, setUser] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    loadStoredUser();\r\n  }, []);\r\n\r\n  const loadStoredUser = async () => {\r\n    try {\r\n      const storedUser = await AsyncStorage.getItem('@user');\r\n      if (storedUser) {\r\n        setUser(JSON.parse(storedUser));\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading stored user:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const login = async (username, password) => {\r\n    try {\r\n      // Simulate API call delay\r\n      await new Promise(resolve => setTimeout(resolve, 1000));\r\n\r\n      const foundUser = users.find(\r\n        u => u.username === username && u.password === password\r\n      );\r\n\r\n      if (foundUser) {\r\n        const { password: _, ...userWithoutPassword } = foundUser;\r\n        await AsyncStorage.setItem('@user', JSON.stringify(userWithoutPassword));\r\n        setUser(userWithoutPassword);\r\n        return { success: true };\r\n      } else {\r\n        throw new Error('Invalid credentials');\r\n      }\r\n    } catch (error) {\r\n      return {\r\n        success: false,\r\n        error: error.message || 'An error occurred during login'\r\n      };\r\n    }\r\n  };\r\n\r\n  const logout = async () => {\r\n    try {\r\n      await AsyncStorage.removeItem('@user');\r\n      setUser(null);\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Logout error:', error);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const value = {\r\n    user,\r\n    loading,\r\n    login,\r\n    logout,\r\n    isAuthenticated: !!user,\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={value}>\r\n      {!loading && children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useAuth = () => {\r\n  const context = useContext(AuthContext);\r\n  if (!context) {\r\n    throw new Error('useAuth must be used within an AuthProvider');\r\n  }\r\n  return context;\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{"hasCjsExports":false},"sourceType":"module","externalDependencies":[]}