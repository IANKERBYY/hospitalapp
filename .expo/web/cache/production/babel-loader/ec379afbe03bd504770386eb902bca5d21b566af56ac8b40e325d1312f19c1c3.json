{"ast":null,"code":"import React,{useState,useEffect}from'react';import View from\"react-native-web/dist/exports/View\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import Text from\"react-native-web/dist/exports/Text\";import Dimensions from\"react-native-web/dist/exports/Dimensions\";import{Camera}from'expo-camera';import{BarCodeScanner}from'expo-barcode-scanner';import{COLORS,FONTS,SPACING}from'../../styles/theme';import Button from'../../components/common/Button';import{equipment}from'../../data/mockData';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SCREEN_WIDTH=Dimensions.get('window').width;const SCAN_AREA_SIZE=SCREEN_WIDTH*0.7;const QRScannerScreen=({navigation})=>{const[hasPermission,setHasPermission]=useState(null);const[scanned,setScanned]=useState(false);useEffect(()=>{requestCameraPermission();},[]);const requestCameraPermission=async()=>{try{const{status}=await Camera.requestCameraPermissionsAsync();setHasPermission(status==='granted');}catch(error){console.error('Error requesting camera permission:',error);setHasPermission(false);}};const handleBarCodeScanned=({data})=>{setScanned(true);const foundEquipment=equipment.find(item=>item.qrCode===data);if(foundEquipment){navigation.replace('EquipmentDetails',{id:foundEquipment.id});}else{alert('Invalid QR code. Please try scanning a valid equipment QR code.');setScanned(false);}};if(hasPermission===null){return _jsx(View,{style:styles.container,children:_jsx(Text,{style:styles.text,children:\"Requesting camera permission...\"})});}if(hasPermission===false){return _jsxs(View,{style:styles.container,children:[_jsx(Text,{style:styles.errorText,children:\"No access to camera\"}),_jsx(Button,{title:\"Request Permission\",onPress:requestCameraPermission,style:styles.button})]});}return _jsxs(View,{style:styles.container,children:[_jsx(Camera,{style:styles.camera,type:Camera.Constants.Type.back,barCodeScannerSettings:{barCodeTypes:[BarCodeScanner.Constants.BarCodeType.qr]},onBarCodeScanned:scanned?undefined:handleBarCodeScanned,children:_jsxs(View,{style:styles.overlay,children:[_jsxs(View,{style:styles.scanArea,children:[_jsx(View,{style:styles.cornerTL}),_jsx(View,{style:styles.cornerTR}),_jsx(View,{style:styles.cornerBL}),_jsx(View,{style:styles.cornerBR})]}),_jsx(Text,{style:styles.instructions,children:\"Align QR code within the frame to scan\"})]})}),scanned&&_jsx(Button,{title:\"Tap to Scan Again\",onPress:()=>setScanned(false),style:styles.button})]});};const styles=StyleSheet.create({container:{flex:1,backgroundColor:COLORS.black},camera:{flex:1},overlay:{flex:1,backgroundColor:'rgba(0,0,0,0.5)',justifyContent:'center',alignItems:'center'},scanArea:{width:SCAN_AREA_SIZE,height:SCAN_AREA_SIZE,borderWidth:2,borderColor:'transparent',position:'relative'},cornerTL:{position:'absolute',top:0,left:0,width:20,height:20,borderTopWidth:2,borderLeftWidth:2,borderColor:COLORS.white},cornerTR:{position:'absolute',top:0,right:0,width:20,height:20,borderTopWidth:2,borderRightWidth:2,borderColor:COLORS.white},cornerBL:{position:'absolute',bottom:0,left:0,width:20,height:20,borderBottomWidth:2,borderLeftWidth:2,borderColor:COLORS.white},cornerBR:{position:'absolute',bottom:0,right:0,width:20,height:20,borderBottomWidth:2,borderRightWidth:2,borderColor:COLORS.white},text:Object.assign({},FONTS.regular,{fontSize:FONTS.sizes.md,color:COLORS.white,textAlign:'center',margin:SPACING.xl}),errorText:Object.assign({},FONTS.medium,{fontSize:FONTS.sizes.lg,color:COLORS.danger,textAlign:'center',margin:SPACING.xl}),instructions:Object.assign({},FONTS.medium,{fontSize:FONTS.sizes.md,color:COLORS.white,textAlign:'center',marginTop:SPACING.xl}),button:{position:'absolute',bottom:SPACING.xl,left:SPACING.xl,right:SPACING.xl}});export default QRScannerScreen;","map":{"version":3,"names":["React","useState","useEffect","View","StyleSheet","Text","Dimensions","Camera","BarCodeScanner","COLORS","FONTS","SPACING","Button","equipment","jsx","_jsx","jsxs","_jsxs","SCREEN_WIDTH","get","width","SCAN_AREA_SIZE","QRScannerScreen","navigation","hasPermission","setHasPermission","scanned","setScanned","requestCameraPermission","status","requestCameraPermissionsAsync","error","console","handleBarCodeScanned","data","foundEquipment","find","item","qrCode","replace","id","alert","style","styles","container","children","text","errorText","title","onPress","button","camera","type","Constants","Type","back","barCodeScannerSettings","barCodeTypes","BarCodeType","qr","onBarCodeScanned","undefined","overlay","scanArea","cornerTL","cornerTR","cornerBL","cornerBR","instructions","create","flex","backgroundColor","black","justifyContent","alignItems","height","borderWidth","borderColor","position","top","left","borderTopWidth","borderLeftWidth","white","right","borderRightWidth","bottom","borderBottomWidth","Object","assign","regular","fontSize","sizes","md","color","textAlign","margin","xl","medium","lg","danger","marginTop"],"sources":["C:/Users/pablo/HospitalApp/src/screens/QRScanner/QRScannerScreen.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { View, StyleSheet, Text, Dimensions } from 'react-native';\r\nimport { Camera } from 'expo-camera';\r\nimport { BarCodeScanner } from 'expo-barcode-scanner';\r\nimport { COLORS, FONTS, SPACING } from '../../styles/theme';\r\nimport Button from '../../components/common/Button';\r\nimport { equipment } from '../../data/mockData';\r\n\r\nconst SCREEN_WIDTH = Dimensions.get('window').width;\r\nconst SCAN_AREA_SIZE = SCREEN_WIDTH * 0.7;\r\n\r\nconst QRScannerScreen = ({ navigation }) => {\r\n  const [hasPermission, setHasPermission] = useState(null);\r\n  const [scanned, setScanned] = useState(false);\r\n\r\n  useEffect(() => {\r\n    requestCameraPermission();\r\n  }, []);\r\n\r\n  const requestCameraPermission = async () => {\r\n    try {\r\n      const { status } = await Camera.requestCameraPermissionsAsync();\r\n      setHasPermission(status === 'granted');\r\n    } catch (error) {\r\n      console.error('Error requesting camera permission:', error);\r\n      setHasPermission(false);\r\n    }\r\n  };\r\n\r\n  const handleBarCodeScanned = ({ data }) => {\r\n    setScanned(true);\r\n    \r\n    // Find equipment by QR code\r\n    const foundEquipment = equipment.find(item => item.qrCode === data);\r\n    \r\n    if (foundEquipment) {\r\n      navigation.replace('EquipmentDetails', { id: foundEquipment.id });\r\n    } else {\r\n      // QR code not recognized\r\n      alert('Invalid QR code. Please try scanning a valid equipment QR code.');\r\n      setScanned(false);\r\n    }\r\n  };\r\n\r\n  if (hasPermission === null) {\r\n    return (\r\n      <View style={styles.container}>\r\n        <Text style={styles.text}>Requesting camera permission...</Text>\r\n      </View>\r\n    );\r\n  }\r\n\r\n  if (hasPermission === false) {\r\n    return (\r\n      <View style={styles.container}>\r\n        <Text style={styles.errorText}>No access to camera</Text>\r\n        <Button\r\n          title=\"Request Permission\"\r\n          onPress={requestCameraPermission}\r\n          style={styles.button}\r\n        />\r\n      </View>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <Camera\r\n        style={styles.camera}\r\n        type={Camera.Constants.Type.back}\r\n        barCodeScannerSettings={{\r\n          barCodeTypes: [BarCodeScanner.Constants.BarCodeType.qr],\r\n        }}\r\n        onBarCodeScanned={scanned ? undefined : handleBarCodeScanned}\r\n      >\r\n        <View style={styles.overlay}>\r\n          <View style={styles.scanArea}>\r\n            <View style={styles.cornerTL} />\r\n            <View style={styles.cornerTR} />\r\n            <View style={styles.cornerBL} />\r\n            <View style={styles.cornerBR} />\r\n          </View>\r\n          <Text style={styles.instructions}>\r\n            Align QR code within the frame to scan\r\n          </Text>\r\n        </View>\r\n      </Camera>\r\n\r\n      {scanned && (\r\n        <Button\r\n          title=\"Tap to Scan Again\"\r\n          onPress={() => setScanned(false)}\r\n          style={styles.button}\r\n        />\r\n      )}\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: COLORS.black,\r\n  },\r\n  camera: {\r\n    flex: 1,\r\n  },\r\n  overlay: {\r\n    flex: 1,\r\n    backgroundColor: 'rgba(0,0,0,0.5)',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  scanArea: {\r\n    width: SCAN_AREA_SIZE,\r\n    height: SCAN_AREA_SIZE,\r\n    borderWidth: 2,\r\n    borderColor: 'transparent',\r\n    position: 'relative',\r\n  },\r\n  cornerTL: {\r\n    position: 'absolute',\r\n    top: 0,\r\n    left: 0,\r\n    width: 20,\r\n    height: 20,\r\n    borderTopWidth: 2,\r\n    borderLeftWidth: 2,\r\n    borderColor: COLORS.white,\r\n  },\r\n  cornerTR: {\r\n    position: 'absolute',\r\n    top: 0,\r\n    right: 0,\r\n    width: 20,\r\n    height: 20,\r\n    borderTopWidth: 2,\r\n    borderRightWidth: 2,\r\n    borderColor: COLORS.white,\r\n  },\r\n  cornerBL: {\r\n    position: 'absolute',\r\n    bottom: 0,\r\n    left: 0,\r\n    width: 20,\r\n    height: 20,\r\n    borderBottomWidth: 2,\r\n    borderLeftWidth: 2,\r\n    borderColor: COLORS.white,\r\n  },\r\n  cornerBR: {\r\n    position: 'absolute',\r\n    bottom: 0,\r\n    right: 0,\r\n    width: 20,\r\n    height: 20,\r\n    borderBottomWidth: 2,\r\n    borderRightWidth: 2,\r\n    borderColor: COLORS.white,\r\n  },\r\n  text: {\r\n    ...FONTS.regular,\r\n    fontSize: FONTS.sizes.md,\r\n    color: COLORS.white,\r\n    textAlign: 'center',\r\n    margin: SPACING.xl,\r\n  },\r\n  errorText: {\r\n    ...FONTS.medium,\r\n    fontSize: FONTS.sizes.lg,\r\n    color: COLORS.danger,\r\n    textAlign: 'center',\r\n    margin: SPACING.xl,\r\n  },\r\n  instructions: {\r\n    ...FONTS.medium,\r\n    fontSize: FONTS.sizes.md,\r\n    color: COLORS.white,\r\n    textAlign: 'center',\r\n    marginTop: SPACING.xl,\r\n  },\r\n  button: {\r\n    position: 'absolute',\r\n    bottom: SPACING.xl,\r\n    left: SPACING.xl,\r\n    right: SPACING.xl,\r\n  },\r\n});\r\n\r\nexport default QRScannerScreen;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{"hasCjsExports":false},"sourceType":"module","externalDependencies":[]}